# Лабораторная работа №4. Операции с Ядрами (Свертка) на C# WPF и Emgu.CV (АОЦИ)

Этот проект — четвертая часть в серии учебных приложений по анализу и обработке цифровых изображений. Он посвящен **свертке** — фундаментальной операции, которая лежит в основе большинства фильтров обработки изображений.

Проект наглядно показывает, как, меняя небольшую матрицу (называемую **ядром** или **kernel**), можно получить совершенно разные эффекты: от размытия и повышения резкости до выделения границ.

## Функционал

Приложение позволяет применять к изображению классические фильтры на основе свертки:

*   **Размытие:**
    *   **Простое размытие:** Усреднение пикселей.
    *   **Размытие по Гауссу:** Более качественное размытие с весами.
*   **Повышение резкости:** Увеличение локального контраста на границах объектов.
*   **Выделение границ (Оператор Собеля):**
    *   Обнаружение вертикальных границ (Sobel X).
    *   Обнаружение горизонтальных границ (Sobel Y).
    *   Обнаружение всех границ (Sobel XY).
*   **Пользовательский фильтр:**
    *   Интерактивная сетка 3x3, куда можно вписать значения **собственного ядра** и увидеть результат его применения.

## Ключевые концепции, продемонстрированные в проекте

### 1. Что такое Свертка?

Свертка — это математическая операция, при которой новое значение каждого пикселя вычисляется на основе взвешенной суммы его соседей.

*   Процесс похож на "скользящее окно": небольшая матрица (**ядро**) "проезжает" по каждому пикселю исходного изображения.
*   В каждой точке значения пикселей под окном умножаются на соответствующие значения в ядре, и все результаты суммируются.
*   Эта сумма и становится новым значением центрального пикселя.

**В коде:** основной алгоритм реализован в методе `ApplyConvolution()`.

### 2. Ядро (Kernel)

Этот проект показывает, что один и тот же алгоритм свертки может выполнять совершенно разные задачи. Вся логика фильтра заключена в маленькой матрице — ядре:

*   **Ядро для размытия:** Все значения одинаковые, их сумма равна 1. Это усредняет пиксели.
*   **Ядро для резкости:** Центральный элемент — большой и положительный, а окружающие — отрицательные. Это усиливает разницу между пикселем и его соседями.
*   **Ядро для выделения границ:** Асимметричное, с положительными и отрицательными значениями. Оно реагирует на резкий перепад яркости в определенном направлении.

### 3. Выделение границ и работа с типами данных

Оператор Собеля — классический пример многоэтапного процесса на основе свертки:

1.  **Конвертация в серое:** Границы — это перепады яркости, а не цвета, поэтому сначала мы избавляемся от цветовой информации.
2.  **Применение свертки:** Применяем ядра Собеля для X и Y.
3.  **Использование `Image<Gray, float>`:** Результат свертки для выделения границ может быть **отрицательным** или **больше 255**. Стандартный `byte` не может хранить такие значения, поэтому мы используем `float` для промежуточных вычислений градиента.
4.  **Нормализация:** Чтобы отобразить `float` изображение с широким диапазоном значений, мы "растягиваем" его значения так, чтобы самое темное стало 0, а самое светлое — 255. Только после этого результат можно конвертировать обратно в `byte` и показать на экране.

### 4. Интерактивное создание фильтров

Возможность вписать свое ядро — лучший способ понять свертку.
